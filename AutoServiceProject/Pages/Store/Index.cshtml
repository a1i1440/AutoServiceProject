@page
@model AutoServiceProject.Pages.Store.IndexModel
@{
    ViewData["Title"] = "Store";
    var cartItemCount = CartHelper.GetCartCount(HttpContext);

}
<div id="floatingCart" style="position: fixed; bottom: 20px; right: 20px; z-index: 9999;">
    <a href="/Store/Cart" class="btn btn-danger rounded-circle d-flex align-items-center justify-content-center position-relative" style="width: 60px; height: 60px;">
        <i class="bi bi-cart3 fs-4 text-white"></i>
        @if (cartItemCount > 0)
        {
            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-warning text-dark">
                @(cartItemCount > 9 ? "9+" : cartItemCount.ToString())
            </span>
        }

    </a>
</div>

<div class="position-fixed top-0 end-0 p-3" style="z-index: 1055">

    <div id="cartToast" class="toast align-items-center text-bg-success border-0" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="d-flex">
            <div class="toast-body">
                ✅ Product successfully added to your cart!
            </div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
    </div>
</div>
<section style="position: relative; background-image: url('/images/hero.jpg'); background-size: cover; background-position: center; height: 500px; width: 100vw; margin-left: calc(-50vw + 50%);">
    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5);"></div>
    <div class="d-flex flex-column align-items-center justify-content-center text-center text-white" style="position: relative; height: 100%;">
        <h1 class="display-4 fw-bold">Find Parts For Your Vehicle</h1>
        <p class="lead">Over hundreds of brands and tens of thousands of parts</p>

        <form method="get" class="row g-2 justify-content-center mt-4">
            <div class="col-md-3">
                <input type="text" name="Brand" class="form-control" placeholder="Brand" value="@Model.Brand" />
            </div>
            <div class="col-md-3">
                <select class="form-control" name="Category" style="min-width: 132px;">
                    <option value="">Select Category</option>
                    <option>Body Parts</option>
                    <option>Engine & Drivetrain</option>
                    <option>Interior Parts</option>
                    <option>Wheels Rim</option>
                    <option>Brakes & Suspension</option>
                    <option>Tools & Garage</option>
                    <option>Headlights & Lighting</option>
                </select>
            </div>
            <div class="col-md-2">
                <button type="submit" class="btn btn-danger w-100" style="margin-left: 17px;">Search</button>
            </div>
        </form>
    </div>
</section>

<section class="py-5 bg-light text-center">
    <div class="container">
        <div class="row g-4">
            <div class="col">
                <i class="bi bi-truck fs-1"></i>
                <h5>Free Shipping</h5>
                <p>For orders from $50</p>
            </div>
            <div class="col">
                <i class="bi bi-headset fs-1"></i>
                <h5>Support 24/7</h5>
                <p>Call us anytime</p>
            </div>
            <div class="col">
                <i class="bi bi-shield-check fs-1"></i>
                <h5>100% Safety</h5>
                <p>Only secure payments</p>
            </div>
            <div class="col">
                <i class="bi bi-tags fs-1"></i>
                <h5>Hot Offers</h5>
                <p>Discounts up to 90%</p>
            </div>
        </div>
    </div>
</section>

<section class="py-5">
    <div class="container">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h3 class="mb-0">Shop by Category</h3>
            <a href="#spare-parts" class="btn btn-danger">Shop Now</a>
        </div>
        <div class="row g-4">
            <div class="col-6 col-md-3 text-center">
                <div class="card border-0 h-100">
                    <img src="/images/body-parts.jpg" class="card-img-top p-3" style="height: 150px; object-fit: contain;" alt="Body Parts">
                    <div class="card-body p-2" style="background-color: #f1f1f1;">
                        <h6 class="card-title m-0">Body Parts</h6>
                    </div>
                </div>
            </div>
            <div class="col-6 col-md-3 text-center">
                <div class="card border-0 h-100">
                    <img src="/images/headlights.jpg" class="card-img-top p-3" style="height: 150px; object-fit: contain;" alt="Headlights & Lighting">
                    <div class="card-body p-2" style="background-color: #f1f1f1;">
                        <h6 class="card-title m-0">Headlights & Lighting</h6>
                    </div>
                </div>
            </div>
            <div class="col-6 col-md-3 text-center">
                <div class="card border-0 h-100">
                    <img src="/images/brakes.jpg" class="card-img-top p-3" style="height: 150px; object-fit: contain;" alt="Brakes & Suspension">
                    <div class="card-body p-2" style="background-color: #f1f1f1;">
                        <h6 class="card-title m-0">Brakes & Suspension</h6>
                    </div>
                </div>
            </div>
            <div class="col-6 col-md-3 text-center">
                <div class="card border-0 h-100">
                    <img src="/images/engine.jpg" class="card-img-top p-3" style="height: 150px; object-fit: contain;" alt="Engine & Drivetrain">
                    <div class="card-body p-2" style="background-color: #f1f1f1;">
                        <h6 class="card-title m-0">Engine & Drivetrain</h6>
                    </div>
                </div>
            </div>
            <div class="col-6 col-md-3 text-center">
                <div class="card border-0 h-100">
                    <img src="/images/tools.jpg" class="card-img-top p-3" style="height: 150px; object-fit: contain;" alt="Tools & Garage">
                    <div class="card-body p-2" style="background-color: #f1f1f1;">
                        <h6 class="card-title m-0">Tools & Garage</h6>
                    </div>
                </div>
            </div>
            <div class="col-6 col-md-3 text-center">
                <div class="card border-0 h-100">
                    <img src="/images/interior.jpg" class="card-img-top p-3" style="height: 150px; object-fit: contain;" alt="Interior Parts">
                    <div class="card-body p-2" style="background-color: #f1f1f1;">
                        <h6 class="card-title m-0">Interior Parts</h6>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="py-5" id="spare-parts">
    <div class="container">
        <h3 class="text-center mb-5">Spare Parts</h3>
        <div class="row g-4">
            @foreach (var product in Model.Products)
            {
                <div class="col-6 col-md-4 col-lg-3">
                    <div class="border rounded shadow-sm h-100 p-3">
                        <a asp-page="/Store/Details" asp-route-id="@product.Id">
                            <img src="@product.ImageUrl" class="w-100" style="height: 150px; object-fit: contain;" alt="@product.Name">
                        </a>
                        <div class="mt-3">
                            <h6 class="fw-bold">@product.Name</h6>
                            <p class="text-muted mb-1">@product.Brand</p>
                            <p class="fw-bold">@product.Price.ToString("C")</p>
                            <a class="btn btn-outline-dark w-100" asp-page="/Store/Details" asp-route-id="@product.Id">View Details</a>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
</section>
@section Scripts {
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            var cartAdded = '@TempData["CartAdded"]';
            if (cartAdded === 'True') {
                var toastEl = document.getElementById('cartToast');
                var toast = new bootstrap.Toast(toastEl);
                toast.show();

                setTimeout(() => toast.hide(), 3000); 
            }
        });
    </script>
}